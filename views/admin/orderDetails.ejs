<%- include("../layouts/admin/header.ejs") %>

<!-- Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
/>

<link rel="stylesheet" href="/css/admin/order.css" />

<div class="d-flex">
  <div class="sidebar">
    <h2 class="text-white">Admin Dashboard</h2>
    <a href="/admin/dashboard">Dashboard</a>
    <a href="/admin/users">Users</a>
    <a href="/admin/category">categories</a>
    <a href="/admin/brands">Brands</a>
    <a href="/admin/addProducts">Add Products</a>
    <a href="/admin/products">Products</a>
    <a
      id="live-dashboard-button"
      href="/admin/orders"
      style="
        background-color: #007bff;
        color: white;
        padding: 10px 15px;
        border-radius: 5px;
        text-decoration: none;
      "
      >Orders</a
    >
    <a href="#">Settings</a>
    <a href="/admin/logout">Logout</a>
  </div>

  <div class="main-content flex-grow-1">
    <div class="text-center">
      <h1 class="my-4">Order Management</h1>
    </div>
    <div class="breadcrumb-container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="/admin/dashboard">Dashboard</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">
            Order Management
          </li>
        </ol>
      </nav>
    </div>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Order ID</th>
          <th>Customer Name</th>
          <th>Product Name</th>
          <th>Quantity</th>
          <th>Total Price</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% orders.forEach(order => { %>
        <tr>
          <td>#<%= order.orderId %></td>
          <td><%= order.customerName %></td>
          <td><%= order.productName %></td>
          <td><%= order.quantity %></td>
          <td><%= order.totalPrice %></td>
          <td>
            <span
              class="badge <%= order.itemStatus === 'Delivered' ? 'bg-success' : order.itemStatus === 'Returned'? 'bg-danger' : order.itemStatus === 'Cancelled'? 'bg-danger' : 'bg-warning' %>"
            >
              <%= order.itemStatus %>
            </span>
          </td>
          <td>
            <!-- Form for updating the status -->
            <form action="/admin/orders/update-status" method="post">
              <input
                type="hidden"
                name="orderId"
                value="<%= order.orderId %>"
              />
              <input
                type="hidden"
                name="productId"
                value="<%= order.productId %>"
              />
              <select name="status" class="form-select">
                <option value="Pending" <%= order.status === 'Pending' ?
                'selected' : '' %>>Pending <option value="Processing" <%=
                order.status === 'Processing' ? 'selected' : '' %>>Processing
                <option value="Shipped" <%= order.status === 'Shipped' ?
                'selected' : '' %>>Shipped <option value="Delivered" <%=
                order.status === 'Delivered' ? 'selected' : '' %>>Delivered
                <option value="Cancelled" <%= order.status === 'Cancelled' ?
                'selected' : '' %>>Cancelled <option value="Returned" <%=
                order.status === 'Returned' ? 'selected' : '' %>>Returned
              </select>
              <button type="submit" class="btn btn-primary btn-sm mt-2">
                Update
              </button>
            </form>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<%- include('../layouts/admin/footer.ejs') %>
